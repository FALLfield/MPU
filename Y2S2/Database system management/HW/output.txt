1. List all the information in the Employee table.
SQL> select * from Employee;
EID        FNAME     LNAME     ADDRESS						                      DOB	   G	 SALARY      BONUS	  DID
---------- --------- --------- -------------------------------------------------- --------- - ---------- ---------- ----------
123        Wilson    Ho        163 Old Road, Bayswater, London			          10-DEC-55 M	  15000		           12
111        John      Simon     883 Fair Road, Coventry				              07-SEP-60 M	  30000		           12
222        Lucas     Tse       569 Heddon Street, Mayfair, London		          02-APR-70 M	  20000       5000	   10
333        Rebecca   Sam       10 Grove Lane, Ipswich, Suffolk			          08-JAN-50 F	  35000       2500	   10
987        Terry     Shooter   26 York Street, London				              30-MAY-73 M	  23000		           12
654        Lawrence  Yip       11-15 Betterton Street, Covent Garden, London	  27-FEB-53 M	  32000		           11
321        Gary      Marker    221 Holloway Road, London			              16-NOV-63 F	  26000		           12
881        James     Steve     321 Voctory Road, Coventry			              31-DEC-71 M	  28000		           12
456        Mary      Law       134,Leicester Square,London			              05-OCT-65 M	  19000		           11
789        Paul      Smith     356 The Queen's Walk,Lodon			              06-AUG-75 F	  14000		           11

10 rows selected

2. List the employees who live in London.
SQL> SELECT * FROM Employee WHERE Address like'%London%';
EID        FNAME     LNAME     ADDRESS						                      DOB	    G	 SALARY      BONUS	  DID
---------- --------- --------- -------------------------------------------------- --------- - ---------- ---------- ----------
123        Wilson    Ho        163 Old Road, Bayswater, London			          10-DEC-55 M	  15000		           12
222        Lucas     Tse       569 Heddon Street, Mayfair, London		          02-APR-70 M	  20000       5000	   10
987        Terry     Shooter   26 York Street, London				              30-MAY-73 M	  23000		           12
654        Lawrence  Yip       11-15 Betterton Street, Covent Garden, London	  27-FEB-53 M	  32000		           11
321        Gary      Marker    221 Holloway Road, London			              16-NOV-63 F	  26000		           12
456        Mary      Law       134,Leicester Square,London			              05-OCT-65 M	  19000		           11

6 rows selected

3. List the full information of all the managers that were employed in 1995.
SQL> SELECT Employee.*, Department.name, Department.Mgr_Start_Date FROM Employee JOIN Department on Employee.EID = Department.Mgr_EID WHERE EXTRACT(YEAR FROM Mgr_Start_Date) = 1995;
EID         FNAME     LNAME     ADDRESS						                      DOB	    G	 SALARY      BONUS	  DID                        NAME					MGR_START
---------- --------- --------- -------------------------------------------------- --------- - ---------- ---------- ---------- ---------------------------------------- ---------
654         Lawrence  Yip       11-15 Betterton Street, Covent Garden, London	  27-FEB-53 M	  32000		          11            Industrial Products Department		01-MAY-95

1 row selected

4. List the full information of all the employees that were born in 70s.
SQL> SELECT * FROM Employee WHERE EXTRACT(YEAR FROM DOB) >= 1970 AND EXTRACT(YEAR FROM DOB) <= 1979;
EID         FNAME     LNAME     ADDRESS						                        DOB	    G	 SALARY      BONUS	  DID
---------- --------- --------- -------------------------------------------------- --------- - ---------- ---------- ----------
222         Lucas     Tse       569 Heddon Street, Mayfair, London		          02-APR-70 M	  20000       5000	   10
987         Terry     Shooter   26 York Street, London				              30-MAY-73 M	  23000		           12
881         James     Steve     321 Voctory Road, Coventry			              31-DEC-71 M	  28000		           12
789         Paul      Smith     356 The Queen's Walk,Lodon			              06-AUG-75 F	  14000		           11

4 rows selected

5. List the full information of all the employees that were born in August.
SQL> SELECT * FROM Employee WHERE EXTRACT(MONTH FROM DOB) = 8;
EID        FNAME     LNAME     ADDRESS						                        DOB	    G	 SALARY      BONUS	  DID
---------- --------- --------- -------------------------------------------------- --------- - ---------- ---------- ----------
789         Paul      Smith     356 The Queen's Walk,Lodon			              06-AUG-75 F	  14000		          11

1 row selected

6. List the full information of all the employees whose age is greater than 50.
SQL> SELECT * FROM Employee WHERE
    EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM DOB) > 50
    OR (EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM DOB) = 50
        AND EXTRACT(MONTH FROM CURRENT_DATE) > EXTRACT(MONTH FROM DOB))
    OR (E  2  XTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM DOB) = 50
        AND EXTRACT(MONTH FROM CURRENT_DATE) = EXTRACT(MONTH FROM DOB)
        AND EXTRACT(DAY FROM CURRENT_DATE)   3  >= EXTRACT(DAY FROM DOB));
  4    5    6    7  

       EID FNAME     LNAME     ADDRESS						                        DOB	   G	 SALARY      BONUS	  DID
---------- --------- --------- -------------------------------------------------- --------- - ---------- ---------- ----------
       123 Wilson    Ho        163 Old Road, Bayswater, London			          10-DEC-55 M	  15000		           12
       111 John      Simon     883 Fair Road, Coventry				              07-SEP-60 M	  30000		           12
       222 Lucas     Tse       569 Heddon Street, Mayfair, London		          02-APR-70 M	  20000       5000	   10
       333 Rebecca   Sam       10 Grove Lane, Ipswich, Suffolk			          08-JAN-50 F	  35000       2500	   10
       987 Terry     Shooter   26 York Street, London				              30-MAY-73 M	  23000		           12
       654 Lawrence  Yip       11-15 Betterton Street, Covent Garden, London	  27-FEB-53 M	  32000		           11
       321 Gary      Marker    221 Holloway Road, London			              16-NOV-63 F	  26000		           12
       881 James     Steve     321 Voctory Road, Coventry			              31-DEC-71 M	  28000		           12
       456 Mary      Law       134,Leicester Square,London			              05-OCT-65 M	  19000		           11

9 rows selected.

7.List the name of the manager of each department.
SQL> SELECT CONCAT(Employee.Fname, Employee.Lname) AS mgr_name, Department.name FROM Employee JOIN Department ON Employee.EID = Department.Mgr_EID;

MGR_NAME	        NAME
------------------ ----------------------------------------
RebeccaSam	        Consumer Products Department
LawrenceYip	        Industrial Products Department
JohnSimon	        Research Department

8. List the name of the youngest manager.
SQL> SELECT CONCAT(e.Fname,e.Lname) AS youngest_mgr 
FROM Employee e INNER JOIN Department d ON e.EID = d.Mgr_EID 
WHERE e.DOB=(SELECT MAX(e.DOB) FROM Employee e INNER JOIN Department d ON e.EID = d.Mgr_EID);  2    3  

YOUNGEST_MGR
------------------
JohnSimon

9. How many employees are there and they are living in London?
SQL> SELECT COUNT(*) emmployee_num FROM Employee WHERE Address LIKE '%London%';

EMMPLOYEE_NUM
-------------
	   6

10.How many male and female employees are there in each department? The department names should be shown in the result.
SQL> SELECT d.name, 
       SUM(CASE WHEN e.Gender = 'M' THEN 1 ELSE 0 END) AS MaleCount,
       SUM(CASE WHEN e.Gender = 'F' THEN 1 ELSE 0 END) AS FemaleCount
FROM Department d
JOIN Employee e ON d.DID = e.DID
GROUP BY d.name;  2    3    4    5    6  

NAME					                 MALECOUNT  FEMALECOUNT
---------------------------------------- ---------- -----------
Research Department				            4	     1
Consumer Products Department			    1	     1
Industrial Products Department			    2	     1

11. Find minimum, maximum, and average employee salary
SQL> SELECT MAX(Salary) AS maximum, MIN(Salary) AS minimum, SUM(Salary)/COUNT(Salary) AS average
FROM (
    SELECT Salary FROM Employee ORDER BY Salary DESC
) Salary;  2    3    4  

 MAXIMUM    MINIMUM	  AVERAGE
---------- ---------- ----------
35000	    14000	  24200

12. Find number of employees and sum of their salaries in each department. The department names should be shown in the result.
SQL> SELECT COUNT(e.EID) as employee_num, SUM(e.Salary) as sal_sum, d.name
FROM Employee e 
JOIN Department d ON e.DID = d.DID 
GROUP BY d.name;  2    3    4  

EMPLOYEE_NUM	SAL_SUM NAME
------------ ---------- ----------------------------------------
	  5	      122000    Research Department
	  2	      55000     Consumer Products Department
	  3	      65000     Industrial Products Department

13.List the department which employs the lowest number of employees.
LOWEST_EMPLOYEE_NUM
-------------------
		 2

14. List the employees who have bonus?
SQL> SELECT CONCAT(Fname, Lname) as name 
FROM Employee
WHERE bonus IS NOT NULL;  2    3  

NAME
------------------
LucasTse
RebeccaSam

15.Find out how many employees do not have bonus?
SQL> SELECT COUNT(*) as no_bonus
FROM Employee
WHERE bonus IS NULL;  2    3  

  NO_BONUS
----------
	8

16. List the total income of each employee. The employee names should be shown in the result.

SQL> SELECT CONCAT(Fname, Lname) AS name, (COALESCE(bonus,0) + Salary) AS income
FROM Employee;  2  

NAME		      INCOME
------------------ ----------
WilsonHo		15000
JohnSimon		30000
LucasTse		25000
RebeccaSam		37500
TerryShooter		23000
LawrenceYip		32000
GaryMarker		26000
JamesSteve		28000
MaryLaw 		19000
PaulSmith		14000

10 rows selected.

17.Find out the number of employees who did not work on any project.
SQL> SELECT COUNT(*) as no_work
FROM Employee e 
LEFT JOIN Work_On w ON w.EID = e.EID 
WHERE w.PID IS NULL;  2    3    4  

   NO_WORK
----------
	1

18. Who is the youngest female employee? Full information should be shown.
SQL> SELECT *
FROM Employee
WHERE DOB = (
    SELECT MIN(DOB)
    FROM Employee
    WHERE Gender = 'F'
);  2    3    4    5    6    7  

       EID FNAME     LNAME     ADDRESS						                        DOB	    G	 SALARY      BONUS	  DID
---------- --------- --------- -------------------------------------------------- --------- - ---------- ---------- ----------
       333 Rebecca   Sam       10 Grove Lane, Ipswich, Suffolk			          08-JAN-50 F	  35000       2500	   10

19. Find out the average age of each department. The department names should be shown in the result.
SQL> SELECT ROUND(SUM(EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM e.DOB))/COUNT(e.EID)) as avg_age, d.name 
FROM Employee e 
JOIN Department d ON e.DID = d.DID 
GROUP BY d.name;  2    3    4  

   AVG_AGE NAME
---------- ----------------------------------------
	60 Research Department
	64 Consumer Products Department
	60 Industrial Products Department

20. Who has the highest accumulated project hours? Full information should be shown
SQL> SELECT e.*, subquery.max_hours
FROM Employee e
JOIN (
    SELECT w.EID, SUM(w.hours) AS max_hours
    FROM Work_On w
    GROUP BY w.EID
) subquery ON e.EID = subquery.EID
WHERE subquery.max_hours = (
    SELECT MAX(SUM(w.hours))
    FROM Wor  2  k_On w
    GROUP BY w.EID
);  3    4    5    6    7    8    9   10   11   12  

       EID FNAME     LNAME     ADDRESS						     DOB	 G  SALARY      BONUS	DID	  MAX_HOURS
---------- --------- --------- -------------------------------------------------- --------- - ---------- ---------- ---------- ----------
       333 Rebecca   Sam       10 Grove Lane, Ipswich, Suffolk			     08-JAN-50 F  35000       2500	       10	      40

21. List all the employees whose age is greater than the average age of all the employees.
SQL> select * from Employee
where trunc(months_between(sysdate,DOB)/12)>(select avg(trunc(months_between(sysdate,DOB)/12)) from Employee);  2  

       EID FNAME     LNAME     ADDRESS						      DOB	 G	SALARY      BONUS	  DID
---------- --------- --------- -------------------------------------------------- --------- - ---------- ---------- ----------
       123 Wilson    Ho        163 Old Road, Bayswater, London			     10-DEC-55 M	 15000		       12
       111 John      Simon     883 Fair Road, Coventry				     07-SEP-60 M	 30000		       12
       333 Rebecca   Sam       10 Grove Lane, Ipswich, Suffolk			     08-JAN-50 F	 35000       2500	10
       654 Lawrence  Yip       11-15 Betterton Street, Covent Garden, London	     27-FEB-53 M	 32000		       11
       321 Gary      Marker    221 Holloway Road, London			     16-NOV-63 F	 26000		       12

22. Find all employees whose age is larger than the age of at least one employee in the Research Department.
SQL> select * from Employee
where trunc(months_between(sysdate,DOB)/12)>(select min(trunc(months_between(sysdate,DOB)/12)) 
       from Employee
       where DID=12
);  2    3    4    5

       EID FNAME     LNAME     ADDRESS						      DOB	 G  SALARY      BONUS	  DID
---------- --------- --------- -------------------------------------------------- --------- - ---------- ---------- ----------
       123 Wilson    Ho        163 Old Road, Bayswater, London			     10-DEC-55 M	  15000		   12
       111 John      Simon     883 Fair Road, Coventry				     07-SEP-60 M	  30000		   12
       222 Lucas     Tse       569 Heddon Street, Mayfair, London		     02-APR-70 M	  20000       5000	   10
       333 Rebecca   Sam       10 Grove Lane, Ipswich, Suffolk			     08-JAN-50 F	  35000       2500	   10
       654 Lawrence  Yip       11-15 Betterton Street, Covent Garden, London	     27-FEB-53 M	  32000		   11
       321 Gary      Marker    221 Holloway Road, London			     16-NOV-63 F	  26000		   12
       881 James     Steve     321 Voctory Road, Coventry			     31-DEC-71 M	  28000		   12
       456 Mary      Law       134,Leicester Square,London			     05-OCT-65 M	  19000		   11

8 rows selected.

